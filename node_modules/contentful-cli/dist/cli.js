'use strict';

var _yargs = require('yargs');

var _yargs2 = _interopRequireDefault(_yargs);

var _log = require('./utils/log');

var _middlewares = require('./utils/middlewares');

var _package = require('../package.json');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

_yargs2.default.usage('\nUsage: contentful <cmd> [args]').commandDir('cmds').middleware([_middlewares.getCommand, _middlewares.buildContext, _middlewares.assertContext]).scriptName('').demandCommand(4, 'Please specify a command.').help('h').alias('h', 'help').strict().recommendCommands().option('v', {
  alias: 'version',
  global: false,
  type: 'boolean',
  describe: 'Show current version',
  skipValidation: true
}).version(false).epilog('Copyright 2018 Contentful, this is a BETA release').fail(function (msg, err, yargs) {
  if (err) throw err;
  console.error(yargs.help());
  console.error(msg);
  process.exit(1);
}).parse(process.argv.slice(2), (_, argv, output) => {
  if (argv.version === true && !argv._.length) {
    (0, _log.log)(_package.version);
  } else {
    (0, _log.log)(output);
  }
});